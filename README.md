# 漫流音

## 功能介绍
#### 本项目是一个FM音乐项目，提供了以下功能：
- 暂停/播放
 点击暂停或播放当前音乐
- 下一曲
 点击重新获取当前音乐分类下随机音乐数据并播放
- 收藏
 将当前音乐数据存储在浏览器localStorage中，打开网页时默认播放收藏曲目
- 进度条、时间
 实时显示当前音乐的播放进度和播放时间，可点击进度条到指定音乐播放进度
- 曲名、歌手、歌词
 显示当前播放曲目的曲名、歌手、歌词
- 音乐分类
 点击所选分类播放改分类下的歌曲并出现选中状态
- 屏幕保护
 鼠标静止不动5分钟更改当前页面为屏幕保护页，显示进度条、时间、曲名、歌手、歌词，移动鼠标后恢复原来页面

## 技术介绍
- 项目使用了jQuery
- 写jQuery插件实现歌词的动画效果
- 利用自定义事件实现事件中心
- 歌曲收藏后信息保存在localStorage中
- 鼠标静止不动一段时间后更改页面
#### 项目实现过程中主要遇到以下难点：
- 事件中心的发布订阅模式理解不清晰
- 歌曲没有歌词时报错问题
- 当收藏多首歌曲时点击下一曲不能更换曲目
- 歌曲分类的AJAX请求地址为HTTP协议而github预览地址为HTTPS协议无法加载分类问题
- 屏幕保护页面不能覆盖原页面的问题。
#### 如何解决：
- 事件中心的发布订阅模式主要通过查阅自定义事件的资料和举例，在jsbin中实验后理解
- 歌曲没有歌词时报错问题可在歌词放在DOM之前判断歌词是否存在在执行
- 收藏歌曲点击下一曲问题在开始时获取对象属性数组中下标为0的sid，然后获取localStorage相应sid的歌曲并播放，每次点击下一曲时将下标+1，当下标等于数组值的个数时在将下标设为0，就实现多首收藏歌曲之间循环的效果
- 分类的AJAX请求地址为HTTP协议而github预览地址为HTTPS协议无法加载分类问题使用相对协议提示不提供安全的链接，将需获取数据下载下来放到github上，将AJAX请求地址换成放入数据的github地址，问题解决，后发现分类数据获取是有HTTPS的api，换回提供的HTTPS的api
- 屏幕保护页面不能覆盖原页面的问题，开始时使用z-index设置两页面之间触发事件后交替覆盖，发现无法实现，查找资料了解z-index只对除position: static默认值的定位元素生效，后转而使用```display:block、display:none```相互切换实现

## 项目收获
- 对事件中心的发布订阅模式有较清晰的认知
- 学会使用正则匹配时间和歌词并在播放过程中放到DOM上
- 了解jQuery插件的写法
- 左右切换分类选项时移动的宽度计算思路
- z-index的使用限制
- 将数据保存在localStorage
- 鼠标移动事件

## 技术栈关键字
 - jQuery、CSS3、响应式、事件中心、正则表达式、localStorage、jQuery插件、音乐api
